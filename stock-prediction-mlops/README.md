# üß† Stock Price Prediction Platform

–ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π ML-–ø—Ä–æ–µ–∫—Ç —Å –ø–∞–π–ø–ª–∞–π–Ω–æ–º CI/CD –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Ü–µ–Ω –∞–∫—Ü–∏–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `MLflow`, `LakeFS`, `tsfresh`, `MinIO`, `GitLab CI` –∏ `Docker`.

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

.
‚îú‚îÄ‚îÄ config.yaml # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –º–æ–¥–µ–ª–∏, –¥–∞–Ω–Ω—ã—Ö –∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è

‚îú‚îÄ‚îÄ docker/ # Dockerfile-—ã –ø–æ —Å–µ—Ä–≤–∏—Å–∞–º

‚îÇ ‚îú‚îÄ‚îÄ api/ # FastAPI-—Å–µ—Ä–≤–∏—Å –¥–ª—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ –º–æ–¥–µ–ª–∏

‚îÇ ‚îú‚îÄ‚îÄ trainer/ # –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –æ–±—É—á–µ–Ω–∏—è

‚îÇ ‚îî‚îÄ‚îÄ mlflow/ # –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è MLflow Tracking Server

‚îú‚îÄ‚îÄ docker-compose.yml # –ü–æ–¥–Ω–∏–º–∞–µ—Ç –≤—Å—ë –æ–∫—Ä—É–∂–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ

‚îú‚îÄ‚îÄ .gitlab-ci.yml # CI/CD pipeline

‚îú‚îÄ‚îÄ requirements.txt

‚îú‚îÄ‚îÄ scripts/

‚îÇ ‚îî‚îÄ‚îÄ train.sh # –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –≤—Ä—É—á–Ω—É—é

‚îî‚îÄ‚îÄ src/

‚îú‚îÄ‚îÄ api/ # FastAPI REST-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

‚îú‚îÄ‚îÄ data/

‚îÇ ‚îú‚îÄ‚îÄ loader.py # –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ S3 / Stooq

‚îÇ ‚îî‚îÄ‚îÄ processing.py # –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ —Ñ–æ—Ä–º–∞—Ç tsfresh

‚îú‚îÄ‚îÄ evaluation/

‚îÇ ‚îî‚îÄ‚îÄ drift_check.py # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—Ä–µ–π—Ñ–∞ –¥–∞–Ω–Ω—ã—Ö (Evidently)

‚îú‚îÄ‚îÄ features/

‚îÇ ‚îî‚îÄ‚îÄ extract.py # –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ tsfresh

‚îî‚îÄ‚îÄ training/

‚îî‚îÄ‚îÄ train_model.py # –û—Å–Ω–æ–≤–Ω–æ–π –ø–∞–π–ø–ª–∞–π–Ω –æ–±—É—á–µ–Ω–∏—è

---

## üõ† –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

### üì¶ Docker + Docker Compose
–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è –∏ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:
- `trainer` ‚Äî –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
- `api` ‚Äî FastAPI —Å–µ—Ä–≤–∏—Å –¥–ª—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞
- `mlflow` ‚Äî —Ç—Ä–µ–∫–∏–Ω–≥ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ –∏ –º–æ–¥–µ–ª–µ–π
- `lakefs` ‚Äî –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- `minio` ‚Äî S3-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ

### üîÑ MLflow
–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π –∏ –º–µ—Ç—Ä–∏–∫.

### FastAPI
REST API-—Å–µ—Ä–≤–∏—Å –¥–ª—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ –º–æ–¥–µ–ª–∏

### üåä LakeFS
–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö: –∫–∞–∂–¥—ã–π –∑–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—É—é –≤–µ—Ç–∫—É –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –¥–∞–Ω–Ω—ã—Ö (—á–µ—Ä–µ–∑ `lakefs_client`).

### üìä Evidently
–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—Ä–µ–π—Ñ–∞ –¥–∞–Ω–Ω—ã—Ö –¥–æ –¥–µ–ø–ª–æ—è –º–æ–¥–µ–ª–∏ –≤ API.

### üíæ MinIO (–æ–±—ë—Ä—Ç–∫–∞ –Ω–∞–¥ Yandex S3)
–ü—Ä–æ–∫—Å–∏ –º–µ–∂–¥—É LakeFS –∏ Yandex S3 ‚Äî –Ω–µ–æ–±—Ö–æ–¥–∏–º –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ –ø–æ–¥–ø–∏—Å–µ–π AWSv4

### ü§ñ tsfresh
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏–∑ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤.

### Yandex Cloud Object Storage (S3)
–•—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è –¥–∞–Ω–Ω—ã—Ö –∏ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ –º–æ–¥–µ–ª–µ–π

### üõ† GitLab CI
CI/CD –ø–∞–π–ø–ª–∞–π–Ω:
- —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
- –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ MLflow
- –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥—Ä–µ–π—Ñ–∞

---

### –ü–æ—á–µ–º—É –Ω—É–∂–µ–Ω MinIO?
–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é LakeFS –∏—Å–ø–æ–ª—å–∑—É–µ—Ç AWS-–ø–æ–¥–ø–∏—Å—å –≤–µ—Ä—Å–∏–∏ 4 (AWS Signature v4), —Å –∫–æ—Ç–æ—Ä–æ–π Yandex S3 –Ω–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≤–º–µ—Å—Ç–∏–º –Ω–∞–ø—Ä—è–º—É—é.
–Ø –∏—Å–ø–æ–ª—å–∑—É—é MinIO –≤ —Ä–µ–∂–∏–º–µ Gateway, —á—Ç–æ–±—ã "–ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞—Ç—å" –≤—Å–µ –≤—ã–∑–æ–≤—ã LakeFS –∫ Yandex Object Storage —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –ø–æ–¥–ø–∏—Å—å—é.

–¢–∞–∫–æ–π –æ–±—Ö–æ–¥–Ω–æ–π –ø—É—Ç—å –ø–æ–∑–≤–æ–ª—è–µ—Ç:
- —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω—É—é —Ä–∞–±–æ—Ç—É LakeFS (–≤ —Ç–æ–º —á–∏—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ –∏ –∫–æ–º–º–∏—Ç–æ–≤)
- –Ω–µ –æ—Ç–∫–∞–∑—ã–≤–∞—Ç—å—Å—è –æ—Ç –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤ –Ø–Ω–¥–µ–∫—Å.–û–±–ª–∞–∫–∞
- –∏–∑–±–µ–∂–∞—Ç—å —Ö–∞—Ä–¥–∫–æ–¥–∞ –∏–ª–∏ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö –ø–∞—Ç—á–µ–π

## üîÅ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ (`train_model.py`)**:
   - –ó–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ Stooq API –∏–ª–∏ Yandex S3.
   - –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ LakeFS –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤–µ—Ä—Å–∏—é –¥–∞–Ω–Ω—ã—Ö –≤ S3
   - –ò–∑–≤–ª–µ–∫–∞–µ—Ç –ø—Ä–∏–∑–Ω–∞–∫–∏ —Å –ø–æ–º–æ—â—å—é tsfresh.
   - –æ–±—É—á–∞–µ—Ç –º–æ–¥–µ–ª—å RandomForest
   - –õ–æ–≥–∏—Ä—É–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –º–µ—Ç—Ä–∏–∫–∏ –∏ –º–æ–¥–µ–ª—å –≤ MLflow.
   - –ó–∞–≥—Ä—É–∂–∞–µ—Ç –º–æ–¥–µ–ª—å –∏ –¥–∞–Ω–Ω—ã–µ –æ–±—Ä–∞—Ç–Ω–æ –≤ S3.
   - –§–∏–∫—Å–∏—Ä—É–µ—Ç –≤–µ—Ä—Å–∏—é –¥–∞–Ω–Ω—ã—Ö –≤ LakeFS (–≤–µ—Ç–∫–∞ —Å UUID).

2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—Ä–µ–π—Ñ–∞ (`drift_check.py`)**:
   - –ó–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –æ–±—É—á–µ–Ω–∏—è.
   - –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ç—á—ë—Ç –æ –¥—Ä–µ–π—Ñ–µ —á–µ—Ä–µ–∑ Evidently.
   - –û—Ç—á—ë—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∫–∞–∫ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç –≤ CI.

3. **–†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ API**:
   - –ú–æ–¥–µ–ª—å –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ S3.
   - FastAPI –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç REST-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π.

4. **MLflow UI (mlflow)**:
   - –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ localhost:5000
   - –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –≤—Å–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã, –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –º–æ–¥–µ–ª–∏
5. **CI/CD (—á–µ—Ä–µ–∑ GitLab)**:
   - –≤—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–∞ –ø–æ–¥ GitLab CI
   - –ö–∞–∂–¥—ã–π –ø—É—à –≤ `main` –∑–∞–ø—É—Å–∫–∞–µ—Ç pipeline.
   - –ú–µ—Ç—Ä–∏–∫–∏ –∏ –æ—Ç—á—ë—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è, –º–æ–¥–µ–ª—å –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è.
   - –û—à–∏–±–∫–∏ –≤–æ –≤—Ä–µ–º—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∏–ª–∏ –¥—Ä–µ–π—Ñ–∞ ‚Äî —Å–∏–≥–Ω–∞–ª –∫ —Ä–µ–≤–∏–∑–∏–∏ –º–æ–¥–µ–ª–∏.

---

## ‚úÖ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

1. –ó–∞–ø–æ–ª–Ω–∏—Ç—å .env —Ñ–∞–π–ª –∏ config.yaml
   - cp .env.example .env
   - config.yaml
2. –°–æ–±—Ä–∞—Ç—å –∏ –ø–æ–¥–Ω—è—Ç—å —Å–µ—Ä–≤–∏—Å—ã
   - docker-compose up --build

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –±—É–¥–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è –≤ LakeFS,
–≤–Ω–µ—Å—Ç–∏ –∫–ª—é—á –¥–æ—Å—Ç—É–ø–∞ –∏ —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –≤ config.yaml, –∞ –∑–∞—Ç–µ–º –ø–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
trainer.
